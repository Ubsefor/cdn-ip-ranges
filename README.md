# cdn_ip_ranges

Автоматически собирает списки IP подсетей для популярных CDN (Hetzner, AWS, CDN77 и OVH) и сохраняет их в двух форматах:

- `plain.txt` — обычный список подсетей, по одной записи на строку.
- `clash.txt` — строки вида `IP-CIDR,<IPv4-подсеть>` или `IP-CIDR6,<IPv6-подсеть>` (например, `IP-CIDR,127.0.0.1/32` или `IP-CIDR6,2a01:4f9::/32`) для Clash/Meta.

## Обновление списков

Локально можно перегенерировать данные командой:

```bash
python3 scripts/update_cdn_lists.py
```

Скрипт обращается к официальным источникам:

- Hetzner, CDN77 и OVH — публичный API RIPE Stat для соответствующих ASN (AS24940, AS60068, AS16276).
- AWS — https://ip-ranges.amazonaws.com/ip-ranges.json.

## Проверки качества

Скрипт валидирует результаты перед сохранением:

- гарантирует, что источники вернули непустой список;
- нормализует и сортирует подсети через `ipaddress`;
- удаляет дубликаты и сообщает их количество в stderr, чтобы в репозиторий попадали только уникальные записи.

## График обновления

GitHub Actions workflow `Update CDN IP Lists` (`.github/workflows/update-cdn-lists.yml`) запускается каждые 12 часов и при необходимости коммитит свежие данные в репозиторий.
